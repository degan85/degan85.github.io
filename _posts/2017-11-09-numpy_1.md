---
layout: post
title: "numpy 기초 1"
author: Degan
categories: machine_learning
tags:	jupyter python notebook
original_extension: ipynb
comments: true
---


# 4.1 NumPy ndarray: 다차원 배열 객체


In[
1
]
```python
import numpy as np
```


In[
2
]
```python
data = np.random.randn(2,3)

data
```




    array([[-0.56897612, -1.21494345,  0.64004088],
           [ 1.66838021,  0.87254619,  0.09999529]])




In[
3
]
```python
data * 10
```




    array([[ -5.68976125, -12.14943448,   6.4004088 ],
           [ 16.68380212,   8.7254619 ,   0.9999529 ]])




In[
4
]
```python
data + data
```




    array([[-1.13795225, -2.4298869 ,  1.28008176],
           [ 3.33676042,  1.74509238,  0.19999058]])




In[
5
]
```python
data.shape
```




    (2, 3)




In[
6
]
```python
data.dtype
```




    dtype('float64')



## 4.1.1 ndarray 생성


In[
7
]
```python
data1 = [6, 7.5, 8, 0, 1]

arr1 = np.array(data1)

arr1
```




    array([ 6. ,  7.5,  8. ,  0. ,  1. ])




In[
8
]
```python
arr1.shape
```




    (5,)




In[
9
]
```python
data2 = [[1,2,3,4],[5,6,7,8]]

arr2 = np.array(data2)

arr2
```




    array([[1, 2, 3, 4],
           [5, 6, 7, 8]])




In[
10
]
```python
arr2.ndim
```




    2




In[
11
]
```python
arr2.shape
```




    (2, 4)




In[
12
]
```python
arr1.dtype
```




    dtype('float64')




In[
13
]
```python
arr2.dtype
```




    dtype('int32')




In[
14
]
```python
np.zeros(10)
```




    array([ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.])




In[
15
]
```python
np.zeros((3,6))
```




    array([[ 0.,  0.,  0.,  0.,  0.,  0.],
           [ 0.,  0.,  0.,  0.,  0.,  0.],
           [ 0.,  0.,  0.,  0.,  0.,  0.]])




In[
16
]
```python
np.empty((2,3,2))
```




    array([[[  1.50690534e-312,   0.00000000e+000],
            [  8.76794447e+252,   2.15895723e+227],
            [  6.48224638e+170,   3.67145870e+228]],
    
           [[  9.45337822e-096,   9.03292329e+271],
            [  9.08366793e+223,   1.41075687e+232],
            [  1.16070543e-028,   4.05919345e-317]]])




In[
17
]
```python
np.arange(15)
```




    array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14])



## 4.1.2 ndarray의 자료형


In[
18
]
```python
arr1 = np.array([1,2,3], dtype = np.float64)

arr1
```




    array([ 1.,  2.,  3.])




In[
19
]
```python
arr1.dtype
```




    dtype('float64')




In[
20
]
```python
arr2 = np.array([1,2,3], dtype = np.int32)
```


In[
21
]
```python
arr2.dtype
```




    dtype('int32')




In[
22
]
```python
arr = np.array([1,2,3,4,5])

arr.dtype
```




    dtype('int32')




In[
23
]
```python
float_arr = arr.astype(np.float64)

float_arr.dtype
```




    dtype('float64')



## 4.1.3 배열과 스칼라 간의 연산


In[
24
]
```python
arr = np.array([[1.,2.,3.],[4.,5.,6.]])

arr
```




    array([[ 1.,  2.,  3.],
           [ 4.,  5.,  6.]])




In[
25
]
```python
arr * arr
```




    array([[  1.,   4.,   9.],
           [ 16.,  25.,  36.]])




In[
26
]
```python
arr - arr
```




    array([[ 0.,  0.,  0.],
           [ 0.,  0.,  0.]])




In[
27
]
```python
1 / arr
```




    array([[ 1.        ,  0.5       ,  0.33333333],
           [ 0.25      ,  0.2       ,  0.16666667]])




In[
28
]
```python
arr ** 5
```




    array([[  1.00000000e+00,   3.20000000e+01,   2.43000000e+02],
           [  1.02400000e+03,   3.12500000e+03,   7.77600000e+03]])



## 4.1.4 색인과 슬라이싱 기초


In[
29
]
```python
arr = np.arange(10)

arr
```




    array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])




In[
30
]
```python
arr[5]
```




    5




In[
31
]
```python
arr[5:8]
```




    array([5, 6, 7])




In[
32
]
```python
arr[5:8] = 12

arr
```




    array([ 0,  1,  2,  3,  4, 12, 12, 12,  8,  9])




In[
33
]
```python
arr_slice = arr[5:8]

arr_slice[1]
```




    12




In[
34
]
```python
arr_slice[1] = 12345

arr
```




    array([    0,     1,     2,     3,     4,    12, 12345,    12,     8,     9])




In[
35
]
```python
arr_slice[:] = 64

arr
```




    array([ 0,  1,  2,  3,  4, 64, 64, 64,  8,  9])




In[
36
]
```python
arr2d = np.array([[1,2,3], [4,5,6], [7,8,9]])

arr2d[2]
```




    array([7, 8, 9])




In[
37
]
```python
arr2d[0][2]
```




    3




In[
38
]
```python
arr2d[0,2]
```




    3




In[
39
]
```python
arr3d = np.array([[[1,2,3],[4,5,6]],[[7,8,9],[10,11,12]]])

arr3d
```




    array([[[ 1,  2,  3],
            [ 4,  5,  6]],
    
           [[ 7,  8,  9],
            [10, 11, 12]]])




In[
40
]
```python
arr3d[0]
```




    array([[1, 2, 3],
           [4, 5, 6]])




In[
41
]
```python
old_alues = arr3d[0].copy()

arr3d[0]=42

arr3d
```




    array([[[42, 42, 42],
            [42, 42, 42]],
    
           [[ 7,  8,  9],
            [10, 11, 12]]])




In[
42
]
```python
arr3d[0] = old_alues

arr3d
```




    array([[[ 1,  2,  3],
            [ 4,  5,  6]],
    
           [[ 7,  8,  9],
            [10, 11, 12]]])




In[
43
]
```python
arr2d
```




    array([[1, 2, 3],
           [4, 5, 6],
           [7, 8, 9]])




In[
44
]
```python
arr2d[:2]
```




    array([[1, 2, 3],
           [4, 5, 6]])




In[
45
]
```python
arr2d[:2, 1:]
```




    array([[2, 3],
           [5, 6]])




In[
46
]
```python
arr2d[1, :2]
```




    array([4, 5])




In[
47
]
```python
arr2d[:, :1]
```




    array([[1],
           [4],
           [7]])



## 4.1.5 불리언 색인


In[
48
]
```python
names = np.array(['Bob', 'Joe', 'Will', 'Bob', 'Will', 'Joe', 'Joe'])

data = np.random.randn(7,4)

names
```




    array(['Bob', 'Joe', 'Will', 'Bob', 'Will', 'Joe', 'Joe'],
          dtype='<U4')




In[
49
]
```python
data
```




    array([[ 0.06314081,  0.27466107,  0.54239516, -0.12794835],
           [-0.1123768 ,  0.54387309,  0.90391634,  0.29667123],
           [ 0.36635205, -0.76723846,  1.84464087,  1.43336161],
           [-0.00738301, -0.84263243, -0.48049434,  2.16421658],
           [ 0.57913261, -1.17403342,  1.23384622,  0.48201328],
           [-0.14679743,  0.81118862, -0.03722321, -0.21022008],
           [ 1.79216494,  0.55771789, -0.53786408,  0.46250626]])




In[
50
]
```python
names == 'Bob'
```




    array([ True, False, False,  True, False, False, False], dtype=bool)




In[
51
]
```python
data[names == 'Bob']
```




    array([[ 0.06314081,  0.27466107,  0.54239516, -0.12794835],
           [-0.00738301, -0.84263243, -0.48049434,  2.16421658]])




In[
52
]
```python
data[names == 'Bob', 2:]
```




    array([[ 0.54239516, -0.12794835],
           [-0.48049434,  2.16421658]])




In[
53
]
```python
names != 'Bob'
```




    array([False,  True,  True, False,  True,  True,  True], dtype=bool)




In[
54
]
```python
data[~(names == 'Bob')]
```




    array([[-0.1123768 ,  0.54387309,  0.90391634,  0.29667123],
           [ 0.36635205, -0.76723846,  1.84464087,  1.43336161],
           [ 0.57913261, -1.17403342,  1.23384622,  0.48201328],
           [-0.14679743,  0.81118862, -0.03722321, -0.21022008],
           [ 1.79216494,  0.55771789, -0.53786408,  0.46250626]])




In[
55
]
```python
mask = (names == 'Bob') | (names == 'Will')

mask
```




    array([ True, False,  True,  True,  True, False, False], dtype=bool)




In[
56
]
```python
data[mask]
```




    array([[ 0.06314081,  0.27466107,  0.54239516, -0.12794835],
           [ 0.36635205, -0.76723846,  1.84464087,  1.43336161],
           [-0.00738301, -0.84263243, -0.48049434,  2.16421658],
           [ 0.57913261, -1.17403342,  1.23384622,  0.48201328]])




In[
57
]
```python
data[names != 'Joe'] = 7

data
```




    array([[ 7.        ,  7.        ,  7.        ,  7.        ],
           [-0.1123768 ,  0.54387309,  0.90391634,  0.29667123],
           [ 7.        ,  7.        ,  7.        ,  7.        ],
           [ 7.        ,  7.        ,  7.        ,  7.        ],
           [ 7.        ,  7.        ,  7.        ,  7.        ],
           [-0.14679743,  0.81118862, -0.03722321, -0.21022008],
           [ 1.79216494,  0.55771789, -0.53786408,  0.46250626]])



## 4.1.6 팬시 색인


In[
58
]
```python
arr = np.empty((8,4))

for i in range(8):
    arr[i] = i

arr
```




    array([[ 0.,  0.,  0.,  0.],
           [ 1.,  1.,  1.,  1.],
           [ 2.,  2.,  2.,  2.],
           [ 3.,  3.,  3.,  3.],
           [ 4.,  4.,  4.,  4.],
           [ 5.,  5.,  5.,  5.],
           [ 6.,  6.,  6.,  6.],
           [ 7.,  7.,  7.,  7.]])




In[
59
]
```python
arr[[4,3,0,6]]
```




    array([[ 4.,  4.,  4.,  4.],
           [ 3.,  3.,  3.,  3.],
           [ 0.,  0.,  0.,  0.],
           [ 6.,  6.,  6.,  6.]])




In[
60
]
```python
arr
```




    array([[ 0.,  0.,  0.,  0.],
           [ 1.,  1.,  1.,  1.],
           [ 2.,  2.,  2.,  2.],
           [ 3.,  3.,  3.,  3.],
           [ 4.,  4.,  4.,  4.],
           [ 5.,  5.,  5.,  5.],
           [ 6.,  6.,  6.,  6.],
           [ 7.,  7.,  7.,  7.]])




In[
61
]
```python
arr[[-3,-5,-7]]
```




    array([[ 5.,  5.,  5.,  5.],
           [ 3.,  3.,  3.,  3.],
           [ 1.,  1.,  1.,  1.]])




In[
62
]
```python
arr = np.arange(32).reshape((8,4))

arr
```




    array([[ 0,  1,  2,  3],
           [ 4,  5,  6,  7],
           [ 8,  9, 10, 11],
           [12, 13, 14, 15],
           [16, 17, 18, 19],
           [20, 21, 22, 23],
           [24, 25, 26, 27],
           [28, 29, 30, 31]])




In[
63
]
```python
arr[[1,5,7,2],[0,3,1,2]]
```




    array([ 4, 23, 29, 10])




In[
64
]
```python
arr[1]
```




    array([4, 5, 6, 7])




In[
65
]
```python
arr[[1,5,7,2]][:,[0,3,1,3]]
```




    array([[ 4,  7,  5,  7],
           [20, 23, 21, 23],
           [28, 31, 29, 31],
           [ 8, 11,  9, 11]])




In[
66
]
```python
arr[[1,5,7,2]]
```




    array([[ 4,  5,  6,  7],
           [20, 21, 22, 23],
           [28, 29, 30, 31],
           [ 8,  9, 10, 11]])



## 4.1.7 배열 전치와 축 바꾸기


In[
67
]
```python
arr = np.arange(15).reshape(3,5)

arr
```




    array([[ 0,  1,  2,  3,  4],
           [ 5,  6,  7,  8,  9],
           [10, 11, 12, 13, 14]])




In[
68
]
```python
arr.T
```




    array([[ 0,  5, 10],
           [ 1,  6, 11],
           [ 2,  7, 12],
           [ 3,  8, 13],
           [ 4,  9, 14]])




In[
69
]
```python
arr = np.random.randn(6,3)

np.dot(arr.T, arr)
```




    array([[ 3.29058807,  0.090925  ,  1.0433784 ],
           [ 0.090925  ,  3.10772434, -0.42079712],
           [ 1.0433784 , -0.42079712,  8.87486294]])




In[
70
]
```python
arr = np.arange(16).reshape(2,2,4)

arr
```




    array([[[ 0,  1,  2,  3],
            [ 4,  5,  6,  7]],
    
           [[ 8,  9, 10, 11],
            [12, 13, 14, 15]]])




In[
71
]
```python
arr.transpose((1,0,2))
```




    array([[[ 0,  1,  2,  3],
            [ 8,  9, 10, 11]],
    
           [[ 4,  5,  6,  7],
            [12, 13, 14, 15]]])




In[
72
]
```python
arr
```




    array([[[ 0,  1,  2,  3],
            [ 4,  5,  6,  7]],
    
           [[ 8,  9, 10, 11],
            [12, 13, 14, 15]]])




In[
73
]
```python
arr.swapaxes(1,2)
```




    array([[[ 0,  4],
            [ 1,  5],
            [ 2,  6],
            [ 3,  7]],
    
           [[ 8, 12],
            [ 9, 13],
            [10, 14],
            [11, 15]]])

---

## Reference

[파이썬 라이브러리를 활용한 데이터 분석](http://www.hanbit.co.kr/store/books/look.php?p_code=B6540908288)

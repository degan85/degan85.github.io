---
layout: post
title: "numpy 기초 2"
author: Degan
categories: machine_learning
tags:	jupyter python notebook
original_extension: ipynb
comments: true
---
# 4.2 유니버설 함수


In[
1
]
```python
import numpy as np

arr = np.arange(10)

np.sqrt(arr)
```




    array([ 0.        ,  1.        ,  1.41421356,  1.73205081,  2.        ,
            2.23606798,  2.44948974,  2.64575131,  2.82842712,  3.        ])




In[
2
]
```python
np.exp(arr)
```




    array([  1.00000000e+00,   2.71828183e+00,   7.38905610e+00,
             2.00855369e+01,   5.45981500e+01,   1.48413159e+02,
             4.03428793e+02,   1.09663316e+03,   2.98095799e+03,
             8.10308393e+03])




In[
3
]
```python
x = np.random.randn(8)

y = np.random.randn(8)

x
```




    array([ 1.59537122,  0.69342539, -0.34958435, -0.50012714,  1.23488579,
           -2.24930539,  1.2174817 , -0.71067123])




In[
4
]
```python
y
```




    array([ 0.5368194 ,  1.56400538,  0.16855788,  0.02670979, -1.73887798,
            0.78623129,  1.01010982,  0.15848972])




In[
5
]
```python
np.maximum(x, y)
```




    array([ 1.59537122,  1.56400538,  0.16855788,  0.02670979,  1.23488579,
            0.78623129,  1.2174817 ,  0.15848972])




In[
6
]
```python
arr = np.random.randn(7) * 5

np.modf(arr)
```




    (array([ 0.96932486,  0.47163455,  0.57138184, -0.73087956, -0.87840859,
            -0.73138273, -0.98825542]), array([ 4.,  5.,  1., -2., -0., -9., -8.]))



# 4.3 배열을 사용한 데이터 처리


In[
7
]
```python
points = np.arange(-5, 5, 0.01)

xs, ys = np.meshgrid(points, points)

ys
```




    array([[-5.  , -5.  , -5.  , ..., -5.  , -5.  , -5.  ],
           [-4.99, -4.99, -4.99, ..., -4.99, -4.99, -4.99],
           [-4.98, -4.98, -4.98, ..., -4.98, -4.98, -4.98],
           ..., 
           [ 4.97,  4.97,  4.97, ...,  4.97,  4.97,  4.97],
           [ 4.98,  4.98,  4.98, ...,  4.98,  4.98,  4.98],
           [ 4.99,  4.99,  4.99, ...,  4.99,  4.99,  4.99]])




In[
8
]
```python
import matplotlib.pyplot as plt

z = np.sqrt(xs**2 + ys**2)

z
```




    array([[ 7.07106781,  7.06400028,  7.05693985, ...,  7.04988652,
             7.05693985,  7.06400028],
           [ 7.06400028,  7.05692568,  7.04985815, ...,  7.04279774,
             7.04985815,  7.05692568],
           [ 7.05693985,  7.04985815,  7.04278354, ...,  7.03571603,
             7.04278354,  7.04985815],
           ..., 
           [ 7.04988652,  7.04279774,  7.03571603, ...,  7.0286414 ,
             7.03571603,  7.04279774],
           [ 7.05693985,  7.04985815,  7.04278354, ...,  7.03571603,
             7.04278354,  7.04985815],
           [ 7.06400028,  7.05692568,  7.04985815, ...,  7.04279774,
             7.04985815,  7.05692568]])




In[
9
]
```python
plt.imshow(z, cmap=plt.cm.gray); plt.title("Image plot of $\sqrt{x^2 + y^2}$ for a grid of values");plt.colorbar()
```




    <matplotlib.colorbar.Colorbar at 0xb10ec30>



## 4.3.1 배열연산으로 조건절 표현하기


In[
10
]
```python
xarr = np.array([1.1, 1.2, 1.3, 1.4, 1.5])

yarr = np.array([2.1, 2.2, 2.3, 2.4, 2.5])

cond = np.array([True, False, True, True, False])

result = [(x if c else y) for x, y, c in zip(xarr, yarr, cond)]

result
```




    [1.1000000000000001, 2.2000000000000002, 1.3, 1.3999999999999999, 2.5]




In[
11
]
```python
result = np.where(cond, xarr, yarr)

result
```




    array([ 1.1,  2.2,  1.3,  1.4,  2.5])




In[
12
]
```python
arr = np.random.randn(4,4)

arr
```




    array([[ 0.46658156,  0.68507833, -0.26437841, -0.17039495],
           [-0.54951416,  0.63194114, -0.7433827 ,  0.62367177],
           [-0.72187222,  0.02708771,  1.52614374, -0.59679849],
           [-2.34721301,  1.49554631,  1.11287581,  0.74695717]])




In[
13
]
```python
np.where(arr > 0, 2, -2)
```




    array([[ 2,  2, -2, -2],
           [-2,  2, -2,  2],
           [-2,  2,  2, -2],
           [-2,  2,  2,  2]])




In[
14
]
```python
np.where(arr > 0, 2, arr)
```




    array([[ 2.        ,  2.        , -0.26437841, -0.17039495],
           [-0.54951416,  2.        , -0.7433827 ,  2.        ],
           [-0.72187222,  2.        ,  2.        , -0.59679849],
           [-2.34721301,  2.        ,  2.        ,  2.        ]])



## 4.3.2 수학 메서드와 통계 메서드


In[
15
]
```python
arr = np.random.randn(5,4)

arr.mean()
```




    0.3098298173526195




In[
16
]
```python
np.mean(arr)
```




    0.3098298173526195




In[
17
]
```python
arr.sum()
```




    6.1965963470523899




In[
18
]
```python
arr.mean(axis=1)
```




    array([ 0.3458205 ,  0.35180874, -0.03197836,  0.40633967,  0.47715853])




In[
19
]
```python
arr
```




    array([[-0.94346394, -1.15990524,  0.41852726,  3.06812393],
           [ 0.35344774,  0.12106645, -0.69916524,  1.63188601],
           [-0.4112214 , -0.320925  ,  0.18268761,  0.42154536],
           [-0.58284825,  2.81218418, -0.07644357, -0.52753366],
           [ 1.9440123 ,  1.4847495 , -0.55885886, -0.96126883]])




In[
20
]
```python
arr.sum(0)
```




    array([ 0.35992646,  2.93716988, -0.7332528 ,  3.6327528 ])



## 4.3.3 불리언 배열을 위한 메서드


In[
21
]
```python
arr = np.random.randn(100)

(arr > 0).sum()
```




    49




In[
22
]
```python
bools = np.array([False, False, True, False])

bools.any()
```




    True




In[
23
]
```python
bools.all()
```




    False



## 4.3.4 정렬


In[
24
]
```python
arr = np.random.randn(8)

arr
```




    array([ 2.41758769, -0.77759397,  1.45853011,  0.28192858, -1.81053115,
           -1.47975875, -0.03992658,  1.2677875 ])




In[
25
]
```python
arr.sort()

arr
```




    array([-1.81053115, -1.47975875, -0.77759397, -0.03992658,  0.28192858,
            1.2677875 ,  1.45853011,  2.41758769])




In[
26
]
```python
arr = np.random.randn(5,3)

arr
```




    array([[-1.66155219,  0.50543019,  0.65626575],
           [ 1.57331005, -0.17747653,  0.38150302],
           [-0.41356834,  0.0395677 , -0.636006  ],
           [ 1.38477594, -0.03962599,  1.03830041],
           [-0.64661783, -0.60402273, -1.17446863]])




In[
27
]
```python
arr.sort(1)

arr
```




    array([[-1.66155219,  0.50543019,  0.65626575],
           [-0.17747653,  0.38150302,  1.57331005],
           [-0.636006  , -0.41356834,  0.0395677 ],
           [-0.03962599,  1.03830041,  1.38477594],
           [-1.17446863, -0.64661783, -0.60402273]])




In[
28
]
```python
large_arr = np.random.randn(1000)

large_arr.sort()

large_arr[int(0.05 * len(large_arr))]
```




    -1.645946207973241



## 4.3.5 집합 함수


In[
29
]
```python
names = np.array(['Bob', 'Joe', 'Will', 'Bob', 'Will', 'Joe', 'Joe'])

np.unique(names)
```




    array(['Bob', 'Joe', 'Will'],
          dtype='<U4')




In[
30
]
```python
ints = np.array([3,3,3,2,2,1,1,4,4])

np.unique(ints)
```




    array([1, 2, 3, 4])




In[
31
]
```python
values = np.array([6,0,3,2,5,6])

np.in1d(values, [2,3,6])
```




    array([ True, False,  True,  True, False,  True], dtype=bool)



# 4.4 배열의 파일 입,출력


In[
32
]
```python
arr = np.arange(10)

np.save('some_array', arr)

np.load('some_array.npy')
```




    array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])




In[
33
]
```python
np.savez('array_archive.npz', a=arr, b=arr)

arch = np.load('array_archive.npz')

arch['b']
```




    array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])



## 4.5 선형대수


In[
34
]
```python
from numpy.linalg import inv, qr

X = np.random.randn(5,5)

mat = X.T.dot(X)

inv(mat)
```




    array([[ 1.13831299,  0.67481972,  0.2188098 ,  0.16342812, -0.93630302],
           [ 0.67481972,  1.70345546, -0.33307995,  1.37464591, -3.0674988 ],
           [ 0.2188098 , -0.33307995,  0.49314345, -0.52329795,  0.93116666],
           [ 0.16342812,  1.37464591, -0.52329795,  1.60778661, -3.03043849],
           [-0.93630302, -3.0674988 ,  0.93116666, -3.03043849,  6.54588423]])




In[
35
]
```python
mat.dot(inv(mat))
```




    array([[  1.00000000e+00,   0.00000000e+00,   0.00000000e+00,
              0.00000000e+00,   0.00000000e+00],
           [  2.22044605e-16,   1.00000000e+00,   2.22044605e-16,
             -1.77635684e-15,   3.55271368e-15],
           [ -4.44089210e-16,  -4.44089210e-16,   1.00000000e+00,
              0.00000000e+00,   8.88178420e-16],
           [  4.44089210e-16,  -1.77635684e-15,   0.00000000e+00,
              1.00000000e+00,   0.00000000e+00],
           [  8.88178420e-16,   0.00000000e+00,  -4.44089210e-16,
              0.00000000e+00,   1.00000000e+00]])




In[
36
]
```python
q, r = qr(mat)

r
```




    array([[-3.85065212,  1.92356817,  2.55156768, -6.90853666, -3.25092686],
           [ 0.        , -5.02158853,  1.77062277, -1.82618546, -3.5225328 ],
           [ 0.        ,  0.        , -3.39951817, -4.17245226, -1.47048966],
           [ 0.        ,  0.        ,  0.        , -2.84114542, -1.32945065],
           [ 0.        ,  0.        ,  0.        ,  0.        ,  0.12580314]])



# 4.6 난수 생성


In[
37
]
```python
samples = np.random.normal(size=(4,4))

samples
```




    array([[ 0.24418667,  1.08302028, -0.3234146 , -2.59244843],
           [-1.03487042, -1.297263  ,  0.6266391 , -0.86148227],
           [ 0.77855363,  0.27879264,  0.86848234, -1.21454862],
           [-1.40267341, -0.40407435, -1.07774361, -0.74566056]])




In[
38
]
```python
from random import normalvariate

N = 1000000

%timeit samples = [normalvariate(0,1) for _ in range(N)]
```

    1.12 s ± 21.1 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
    


In[
39
]
```python
%timeit np.random.normal(size=N)
```

    37 ms ± 1.51 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
    

# 4.7 계단 오르내리기 예제


In[
40
]
```python
import random

nsteps = 1000

draws = np.random.randint(0,2,size=nsteps)

steps = np.where(draws > 0, 1, -1)

walk = steps.cumsum()

walk.min()
```




    -27




In[
41
]
```python
walk.max()
```




    20




In[
42
]
```python
(np.abs(walk) >= 10).argmax()
```




    117


---

## Reference

[파이썬 라이브러리를 활용한 데이터 분석](http://www.hanbit.co.kr/store/books/look.php?p_code=B6540908288)